json = '<%=
  flats = Flat.all[0..10]
  URI.encode flats.to_json
%>';
json = JSON.parse(decodeURI(json));
$("#mylist").html(" ")
json.forEach(function(element, i) {
  L.marker([element.latitude,element.longitude]).bindPopup(
    '<div class="collection">'+
    '<div class="collection-item">'+"address : "+element.address+'</div>'+
    '<div class="collection-item">'+"price : "+element.price+'</div>'+
    '<div class="collection-item">'+"surface : "+element.surface+'</div>'+
    '<div class="collection-item">'+"bedroom : "+element.bedroom+'</div>'+
    '</div>'
  ).addTo(this.map)
  $("#mylist").append('<li>'+
          '<div class="collapsible-header">'+
            '<div class="left">Appartement '+i+'&nbsp;&nbsp;&nbsp;'+'</div><div class="right">'+ element.address +'&nbsp;&nbsp;&nbsp;'+ element.district +'</div></div>'+
          '<div class="collapsible-body"><div class="collection">'+
          '<div class="collection-item">'+"price : "+element.price+'</div>'+
          '<div class="collection-item">'+"room : "+element.room+'</div>'+
          '<div class="collection-item">'+"bedroom : "+element.bedroom+'</div>'+
          '<div class="collection-item">'+"surface : "+element.surface+'</div>'+
            '</div></div>'+
        '</li>')
});
